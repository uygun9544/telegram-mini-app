# Telegram Mini App: training + online

В проекте есть 2 режима в одной и той же игре:

- `Тренировка` (верхняя кнопка) — мгновенный старт против бота.
- `Играть` (нижняя кнопка) — поиск реального игрока онлайн.

## Локальный запуск фронта

```bash
npm install
npm run dev
```

## Локальный запуск online-сервера

```bash
cd server
npm install
npm start
```

По умолчанию сервер стартует на `ws://localhost:8787`.

Проверка здоровья сервера:

- `http://localhost:8787/health`

## Динамическая настройка бота тренировки (без перезаливки фронта)

Теперь значения бота тренировки можно менять удалённо через сервер:

- `GET /training-config` — получить текущие значения
- `POST /training-config` — обновить значения

Поддерживаемые поля:

- `reactionMinMs`
- `reactionMaxMs`
- `missChance` (0..1)

Для `POST` обязательно задай env-переменную на Render:

```bash
TRAINING_CONFIG_ADMIN_TOKEN=your_secret_token
```

Пример обновления (без деплоя фронта):

```bash
curl -X POST https://your-render-domain/training-config \
	-H "Content-Type: application/json" \
	-H "X-Admin-Token: your_secret_token" \
	-d '{"reactionMinMs":500,"reactionMaxMs":2300,"missChance":0.25}'
```

Фронтенд подхватывает эти значения автоматически (периодический рефреш).

## Настройка URL сервера для фронта

Создай `.env` в корне фронта:

```bash
VITE_MATCH_WS_URL=ws://localhost:8787
```

Для теста с другом с разных устройств укажи публичный URL твоего сервера, например:

```bash
VITE_MATCH_WS_URL=wss://your-domain.com
```

На главном экране приложения есть debug-подпись `WS: ...` — на обоих устройствах она должна показывать один и тот же адрес.

## Что уже поддержано в MVP

- очередь игроков;
- матч на 2 игроков;
- модалка подтверждения (`Принять игру` / `✕`);
- отмена поиска и отмена найденного матча;
- обмен результатом раунда между 2 игроками.

## Тапки игроков

- Тапок назначается игроку случайно при первом входе и сохраняется локально по `playerId`.
- Добавляй новые тапки в папку `src/assets/slippers` (png/jpg/webp/svg), они автоматически попадут в рандомный пул.
- Базовые тапки `/green.png` и `/pink.png` тоже остаются в пуле.
"# telegram-mini-app" 
